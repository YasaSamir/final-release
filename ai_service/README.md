# خدمة الذكاء الاصطناعي لمشاركة الرحلات

هذه الخدمة توفر تنبؤات الذكاء الاصطناعي لتحسين تجربة مشاركة الرحلات في تطبيق النقل.

## الوظائف الرئيسية

1. **تحليل طلبات مشاركة الرحلات**: تحليل المسارات وتقديم توصيات ذكية حول ما إذا كان يجب قبول طلب المشاركة أم لا.
2. **حساب الكفاءة**: تقدير مدى كفاءة مشاركة الرحلة من حيث المسافة والوقت.
3. **التنبؤ بالفوائد**: تحديد ما إذا كانت مشاركة الرحلة مفيدة للجميع.
4. **حساب التوفير**: تقدير التوفير المالي والبيئي من مشاركة الرحلة.

## المتطلبات

- Python 3.9+
- Flask
- NumPy
- pandas
- scikit-learn
- joblib

## التثبيت

1. قم بإنشاء بيئة Python افتراضية:
   ```bash
   python -m venv venv
   source venv/bin/activate  # على Linux/Mac
   venv\Scripts\activate  # على Windows
   ```

2. قم بتثبيت المتطلبات:
   ```bash
   pip install -r requirements.txt
   ```

## التشغيل

1. قم بتشغيل الخدمة:
   ```bash
   python app.py
   ```

2. الخدمة ستعمل على المنفذ 5000 بشكل افتراضي.

## واجهة برمجة التطبيقات (API)

### التنبؤ بمشاركة الرحلة

**طلب POST إلى `/predict`**

المعلمات:
- `original_distance`: المسافة الأصلية للرحلة (بالكيلومتر)
- `distance_after_adding_rider`: المسافة الجديدة بعد إضافة الراكب (بالكيلومتر)
- `new_rider_distance`: المسافة المباشرة للراكب الجديد (بالكيلومتر)
- `time_of_day` (اختياري): ساعة اليوم (0-23)
- `day_of_week` (اختياري): يوم الأسبوع (0-6، حيث 0 هو الاثنين)
- `traffic_level` (اختياري): مستوى الازدحام (0-1)
- `weather_condition` (اختياري): حالة الطقس (0-4)

مثال للطلب:
```json
{
  "original_distance": 10.5,
  "distance_after_adding_rider": 12.8,
  "new_rider_distance": 8.2,
  "time_of_day": 18,
  "day_of_week": 2,
  "traffic_level": 0.7,
  "weather_condition": 0
}
```

مثال للاستجابة:
```json
{
  "prediction_score": 0.85,
  "add_rider": true,
  "efficiency": 72,
  "fare_details": {
    "original_rider": {
      "original_fare": 31,
      "new_fare": 22,
      "savings": 9
    },
    "new_rider": {
      "direct_fare": 26,
      "shared_fare": 18,
      "savings": 8
    },
    "total_savings": 17
  },
  "environmental_impact": {
    "co2_reduction": 0.984,
    "fuel_saved": 0.66
  }
}
```

### تدريب النموذج

**طلب POST إلى `/train`**

المعلمات:
- مصفوفة من سجلات التدريب

مثال للطلب:
```json
[
  {
    "original_distance": 10.5,
    "distance_after_adding_rider": 12.8,
    "new_rider_distance": 8.2,
    "time_of_day": 18,
    "day_of_week": 2,
    "traffic_level": 0.7,
    "weather_condition": 0,
    "prediction": true,
    "score": 0.85
  },
  ...
]
```

### فحص الصحة

**طلب GET إلى `/health`**

مثال للاستجابة:
```json
{
  "status": "healthy",
  "model_loaded": true,
  "scaler_loaded": true
}
```

## التكامل مع الباكند

يتم استدعاء خدمة الذكاء الاصطناعي من الباكند عند تلقي طلب مشاركة رحلة. يقوم الباكند بحساب المسافات وإرسالها إلى خدمة الذكاء الاصطناعي، ثم يستخدم النتيجة لاتخاذ قرار بشأن طلب المشاركة.

## نموذج الذكاء الاصطناعي

النموذج المستخدم هو Random Forest Classifier، وهو مدرب على بيانات تاريخية لطلبات مشاركة الرحلات. يتم تحديث النموذج بشكل دوري باستخدام بيانات جديدة من التطبيق.

## الميزات المستقبلية

1. دعم نماذج أكثر تقدمًا مثل الشبكات العصبية العميقة.
2. تحسين دقة التنبؤات باستخدام المزيد من المتغيرات مثل سجل المستخدم وتفضيلاته.
3. تحسين حساب التوفير المالي والبيئي.
4. إضافة دعم للتنبؤ بوقت الوصول المقدر (ETA) بدقة أعلى.
5. تحسين تجربة المستخدم من خلال تقديم توصيات أكثر ذكاءً.

## المساهمة

نرحب بالمساهمات! يرجى إرسال طلبات السحب (Pull Requests) أو فتح مشكلات (Issues) للمساعدة في تحسين هذه الخدمة.

## الترخيص

هذا المشروع مرخص بموجب رخصة MIT.
